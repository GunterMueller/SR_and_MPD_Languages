<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
 "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<!-- this file was originally generated by troffcvt and tc2html (THANKS!) -->
<HEAD>
<link rel="StyleSheet" type="text/css" href="/style/simple.css">
<TITLE> Installing the MPD Programming Language </TITLE>
</HEAD>
<BODY BGCOLOR="#F7FFFF">


<!-- /style/csbanner.ssi: included to render CS header with links -->
<!-- compatible with /style/simple.css, but does not require it -->

<img src="/style/elements/genheader.gif" width="760" height="148"
 alt="The University of Arizona / Computer Science / UAScience"
 style="position:absolute; top:0px; left:10px;">

<div style="position:absolute; top:0px; left:10px; width:493px; height:42px;">
<a title="The University of Arizona" href="http://www.arizona.edu/">
<img border="0" alt="The University of Arizona"
 src="/style/elements/42blu493.gif"></a></div>

<div style="position:absolute; top:56px; left:516px; width:150px; height:43px;">
<a title="Computer Science" href="http://www.cs.arizona.edu/">
<img border="0" alt="ComputerScience"
 src="/style/elements/tplDept.gif" width="150" height="43"></a></div>

<div style="position:absolute; top:99px; left:516px; width:150px; height:23px;">
<a title="UAScience" href="http://cos.arizona.edu/">
<img border="0" alt="UAScience"
 src="/style/elements/tplCollg.gif" width="150" height="23"></a></div>

<div style="position:absolute; top:0px; left:760px; width:10px; height:42px;">
<a title="Validate" href="http://validator.w3.org/check?uri=referer&amp;ss=1">
<img border="0" alt=""
 src="/style/elements/42blu10.gif" width="10" height="42"></a></div>

<div style="padding: 150px 0 0 0;"></div>
<div class="up150"></div>

<!-- /style/csbanner.ssi: end inclusion -->




<IMG SRC="cairn.jpg" ALT="" ALIGN=right WIDTH=120 HEIGHT=120>
<H1> Installing the MPD Programming Language </H1>

<P> <A HREF="http://www.cs.arizona.edu/mpd/">
http://www.cs.arizona.edu/mpd</A>
<P> Gregg Townsend
<BR> Department of Computer Science
<BR> The University of Arizona
<BR> January 20, 2004

<H2> General Notes </H2>
<P>
The MPD Programming Language runs under several different Unix
systems including Linux, Solaris, Irix, and Digital Unix. A list
is included in the<B> Systems</B> file in the main directory.
<P>
The MPD system is in the public domain and you may use and distribute
it as you wish.  We ask that you retain credits referencing the
University of Arizona and that you identify any changes you make.
<P>
We can't provide a warranty with MPD; it's up to you to determine
its suitability and reliability for your needs. We would like
to hear of any problems you encounter but we cannot promise a
timely correction.

<H2> System Components </H2>
<P>
The MPD system consists of several components.<B> mpd</B> and<B>
mpdl</B> are the key programs used directly by an MPD programmer.
The MPD runtime system is loaded implicitly by <B>mpdl</B>. Supplemental
tools, example programs, and documentation are also provided.
<P>
<B>mpd</B> is the compiler proper. It translates an MPD program
into a C program and then calls the C compiler to produce object
code.
<P>
<B>mpdl</B> is the MPD linker. It generates tiny C files of configuration
information and invokes the C compiler to combine these with object
files and the runtime library. The end product is an executable
program.
<P>
<B>mpdx</B> is an executive program that supervises &quot;distributed&quot;
MPD programs: those that use <B>create vm()</B>. It is not called
explicitly but is forked automatically by the runtime system.
<P>
<B>mpdm</B> assists in the construction of complex programs by
inspecting MPD source code and automatically creating a correct<I>
make</I> description file.
<P>
<B>mpdprof</B> reads a trace file produced during the execution
of an MPD program and produces a report of event counts by line
number or an annotated listing showing the counts.
<P>
The<B> library</B> contains resources, globals, and externals
that can be linked with MPD programs. It includes an option processor
and interfaces to X Windows and to the XTANGO animation package.
<P>
<B>mpdv</B> runs verification tests to check that the MPD system
is functioning correctly.<B> mpdvi</B> installs new verification
tests. These programs are part of the installation process and
are not used by MPD programmers.

<H2> Directory Structure </H2>
<P>
Important files in the main directory include:<P>
<BLOCKQUOTE>
<DL COMPACT>
<DT> <B>README</B> </DT>
<DD> General release information and last minute notes.  READ THIS FILE!  </DD>
<DT> <B>Systems</B> </DT>
<DD> Detailed system-specific information.  READ THIS, TOO.  </DD>
<DT> <B>Configuration</B> </DT>
<DD> File paths and other miscellaneous configuration data.  </DD>
<DT> <B>Makefile</B> </DT>
<DD> The master file of <I>make</I> directives for building MPD.  </DD>
</DL>
</BLOCKQUOTE>
<P>
There are also several source code files and other files used
in the build process.
<P>
Subdirectories of the main directory are:<P>
<BLOCKQUOTE>
<DL COMPACT>
<DT> <B>mpd</B> </DT>
<DD>
Source code for <B>mpd</B>, the MPD compiler.
</DD>
<DT> <B>mpdl</B> </DT>
<DD>
Source code for <B>mpdl</B>, the MPD linker.
</DD>
<DT> <B>rts</B> </DT>
<DD>
Source code for the MPD runtime system, including <B>mpdx</B>.
</DD>
<DT> <B>library</B> </DT>
<DD>
Source code for the MPD library routines.
</DD>
<DT> <B>csw</B> </DT>
<DD>
Platform-specific runtime code for context switching.
</DD>
<DT> <B>multi</B> </DT>
<DD>
Platform-specific runtime code for multiprocessing support.
</DD>
<DT> <B>mpdm</B> </DT>
<DD>
Source code for <B>mpdm</B>, the Makefile builder.
</DD>
<DT> <B>mpdprof</B> </DT>
<DD>
Source code for <B>mpdprof</B>, the profiler.
</DD>
<DT> <B>mpdv</B> </DT>
<DD>
Source code for <B>mpdv</B> and <B>mpdvi</B>, the verification tools.
</DD>
<DT> <B>links</B> </DT>
<DD>
A collection of symbolic links pointing to locations where the
executables are built. This directory can be put in a search path
to assist in testing.
</DD>
<DT> <B>vsuite</B> </DT>
<DD>
A suite of verification programs used by <B>mpdv</B>.
Most are simple and artificial, but some useful MPD examples
are in <B>vsuite/examples</B>.
</DD>
<DT> <B>man</B> </DT>
<DD>
Individual<I> man</I> pages for the various programs in the MPD
system.
</DD>
<DT> <B>doc</B> </DT>
<DD>
Additional documentation in HTML form.
</DD>
</DL>
</BLOCKQUOTE>

<H2> Configuring the MPD System </H2>
Before you build MPD, you must decide where to install it. Pathnames
are embedded in the binaries so that (for example)<I> mpd</I> can
call<I> mpdl</I> and<I> mpdl</I> can find the runtime library. Five
directories must be specified: one for the commands, one for hidden
files such as the runtime library, and three for the<I> man</I>
pages. All of the installed files have names beginning with<B>
mpd</B>.
<P>
If you plan to install MPD as a local utility you might choose
distinct directories such as<B> /usr/local/bin,</B><B> /usr/local/lib/mpd,</B>
and then<B> /usr/man/manl</B> for all the<I> man</I> pages. Alternatively,
everything can be collected in a single directory such as<B> /usr/mpd/bin</B>
or<B> /home/yourname/bin.</B> Do not use any<I> existing</I> directories
within the MPD distribution, but you can safely create a new<B>
bin</B> subdirectory under the main directory.
<P>
If the directories you have chosen do not now exist, you must
create them manually. The installation process does not create
new directories.
<P>
To configure the system, edit the file<B> Configuration</B> in
the main directory. Change the MPDSRC definition to reflect the
path of the main directory. Define installation directories as
described above for MPDCMD, MPDLIB, MAN1, MAN3, and MAN5. All directories
must be absolute paths (beginning with '/'), and no comments may
appear on the definition lines.
<P>
If the X window system is installed, set XINCL to the parent directory
of the X11 include directory.  Usually, that is<B> /usr/include</B>
or<B> /usr/X11R6/include</B>. On a Sun running OpenWindows, set
XINCL to<B> /usr/openwin/include</B>. If X is not installed, set
XINCL to be empty.
<P>
If you wish to use the animation interface provided in the library,
you must first obtain and install the XTANGO package from Georgia
Tech. At this writing it is available by anonymous FTP from the
/pub/people/stasko directory on<B> ftp.cc.gatech.edu</B>. Then
define XTANGO as the name of the XTANGO<B> include</B> directory.
<P>
A few other values can also be configured in the main<B> Makefile</B>.
MANEXT defines the file extension for installed<I> man</I> pages.
The <I>xx</I>PATH definitions define the location of the C compiler
and other utilities called from within MPD commands, but do<I>
not</I> affect the building of MPD. The CFLAGS definition sets
compilation options for use while building MPD.
<P>
Some operating systems require additional changes to<B> Configuration</B>
and/or<B> Makefile</B>. See the section in the<B> Systems</B>
file describing your particular operating system.

<H2> Configuring for MultiMPD on Solaris </H2>
<P>
A multithreaded version of MPD, called MultiMPD, provides true concurrency
on a multiprocessor Sun SPARC system.
If you have a multiple-CPU Solaris system, you can configure MultiMPD.
(MultiMPD also runs fine on uniprocessors, 
so it a single configuration suffices for a mixed environment.)
<P>
To configure MultiMPD on Solaris, edit the main Makefile and define
<BLOCKQUOTE>
MULTI=solaris
</BLOCKQUOTE>
Edit the Configuration file and define
<BLOCKQUOTE>LIBR=-lthread</BLOCKQUOTE>

<H2> Building and Testing </H2>
<P>
To build the MPD system, simply type
<BLOCKQUOTE><B>make</B></BLOCKQUOTE>
in the main directory. This builds all the components of the MPD
system within the MPD directory structure, altering nothing outside
the structure.
<P>
If you later need to change the configuration information, do
so and again type <B>make</B>. This sort of rebuild goes relatively
quickly because only a few files need to be recompiled.
<P>
After building the system, check that it is functional by entering
<BLOCKQUOTE><B>mpdv/mpdv -v quick</B></BLOCKQUOTE>
to run the &quot;quick&quot; set of MPD tests. This prints some
environmental information and then runs a small set of tests.<B>
-v</B> causes each verification directive to be echoed. The &quot;quick&quot;
tests may actually take a few minutes, even on a fast machine;
quick/jumble, in particular, has grown to over 500 lines of MPD
and is compiled and executed twice.
<P>
No error messages are expected. If &quot;expected 0, got 1 from
$RSHPATH&quot; appears for the<B> quick/vm</B> test, it indicates
a problem running the<I> rsh</I> (or <I>remsh</I>) program. This
is discussed below under<B> Configuring Virtual Machines</B>.
<P>
It is not necessary to complete the installation to manually test
the newly built system. If you put the<B> links</B> subdirectory
in your search path, you can compile MPD programs by running<B>
mpd</B> and<B> mpdl</B> with the<B> -e</B> option. This causes them
to load libraries and other files from within the source directory
instead of from the ultimate, installed locations.

<H2> Installing the System </H2>
<P>
After the system has been built and verified, it must be installed
in its ultimate destination as configured above. Type
<BLOCKQUOTE><B>make install</B></BLOCKQUOTE>
to copy the commands,<I> man</I> pages, and support files.
<P>
To verify a correct installation, type
<BLOCKQUOTE><B>mpdv/mpdv -v -p quick</B></BLOCKQUOTE>
to run the same tests as before, but using the installed files.

<H2> Configuring Virtual Machines </H2>
<P>
At this point, a complete MPD system has been built and installed.
Without further reconfiguration, however, remote virtual machines
may not work properly. This reconfiguration was deferred until
now in order to have a working MPD system as a testbed. If you
don't have a network of machines or don't need to use<B> create
vm() on</B><I> n</I>, you can skip this section. If you're building
MPD on an Intel Paragon, you should also skip this section.
<P>
When a program creates a virtual machine and specifies a host
machine on which to place it, MPD uses a remote shell to run the
program on the remote host. The remote shell program is<I> rsh</I>(1)
on most systems or<I> remsh</I>(1) on some System V derived Unixes.
Set the RSHPATH definition in the Configuration file to name the
correct program. Under Solaris 2, use<B> /bin/rsh</B>.
<P>
Verify that<I> rsh</I> or<I> remsh</I> is working by entering
<BLOCKQUOTE><B>rsh 'hostname' date</B></BLOCKQUOTE>
If necessary, substitute<B> remsh</B> for<B> rsh</B> and/or<B>
uname -n</B> for<B> hostname.</B> If this doesn't print the date,
there is a configuration problem outside of MPD; seek local assistance.
<P>
The name of the executable file passed to<I> rsh</I> is the same
for all remote hosts and is controlled by an<B> mpdmap</B> file.
This contains patterns for matching the program's filename and
corresponding templates for generating the remote filename for<I>
rsh.</I> The format of<B> mpdmap</B> is described in its <I>man</I>
page, <B>man/mpdmap.5</B>.
<P>
If your network provides transparent access to remote disks, it
should be possible to make remote execution work automatically
by specifying templates that generate host-independent filenames.
The<B> mpdmap.az</B> file in the main directory is an example of
how this is done at Arizona.
<P>
Without remote disk access, users of multiple virtual machines
will need to manually copy their programs to the remote hosts
(<I>e.g.</I>, using<I> rcp</I> or<I> rdist</I>) before beginning
execution. The configuration in<B> mpdmap</B> controls where the
programs must be placed, so a simple and straightforward method
is desirable. One way to do this is to generate a path relative
to the user's home directory. For example, if <B>mpdmap</B> contains
the line
<BLOCKQUOTE><B>sequoia:/usr?/*/**     ~$2/$3</B></BLOCKQUOTE>
then when a program<B> /usr3/username/path</B> is run on host
<B>sequoia</B>, MPD expects to find copies of the executable in<B>
~username/path</B> on remote machines.
<P>
Edit<B> mpdmap</B> in the main directory and set up a configuration
appropriate to your local situation. Refer to the<B> mpdmap</B><I>
man</I> page for a detailed description of the format, and use
the Arizona configuration as a starting point and an example.
<P>
Make sure that your search path includes the directory where you
just installed <B>mpd</B>, and type<B> rehash</B> if your shell
requires it. Go into the <B>vsuite/examples/misc/remote</B> subdirectory
and type
<BLOCKQUOTE><B>mpd remote.mpd</B></BLOCKQUOTE>
to compile a test program. Set the environment variable MPDMAP
to the<I> absolute</I> pathname of the new<B> mpdmap</B> file.
<P>
Begin with a simple test by typing
<BLOCKQUOTE><B>a.out</B></BLOCKQUOTE>
to run the program with no arguments. It should simply tell you
the local hostname; this verifies that<B> mpdx</B> is accessible,
and that the location of<B> a.out</B> matches one of the patterns
in <B>mpdmap</B>. Then try giving the local hostname as an explicit
argument; this verifies that the generated filename works on the
present host.
<P>
Now add other hostnames as command arguments; if remote execution
fails (perhaps as expected), then the diagnostics from<I> rsh</I>
give the file name attempted. Copy<B> a.out</B> into other directories,
and onto other hosts if necessary. Run it from various locations
with various hostname arguments. Run it using absolute and relative
paths. Try to test any special cases used in the<B> mpdmap</B>
file.
<P>
When you are satisfied with the configuration in <B>mpdmap</B>,
return to the main directory and type
<BLOCKQUOTE><B>make install</B></BLOCKQUOTE>
to reinstall the system including the revised<B> mpdmap</B> file.

<H2> Cleaning Up </H2>
<P>
After the system has been installed, nothing within the MPD directory
structure is needed to build or run MPD programs. The structure
can be backed up on tape and removed from the disk.
<P>
If you wish to keep the source code online, type
<BLOCKQUOTE><B>make clean</B></BLOCKQUOTE>
to remove executables and intermediate files from the build process.<B>
Warning:</B> the cleanup process is a bit aggressive, and it removes
all files within the directory structure that satisfy certain
tests. If you have created files of your own within the structure,
and you wish to preserve them, it would be prudent to first copy
them elsewhere.

<H2> The Full Verification Suite </H2>
<P>
The <B>mpdv/mpdv quick</B> command, noted above, runs just a small subset
-- the <B>quick</B> subdirectory -- of the MPD verification suite.
That should be sufficient to 
verify correct installation of an unmodified MPD system.
<P>
The full set of over 400 tests can be exercised by running <B>mpdv/mpdv</B>
with no additional parameters.
Most platforms exhibit a few failures;
see the <B>Systems</B> file for details.

<H2> Porting to Other Systems </H2>
<P>
It is possible to port MPD to other system architectures besides
those presently supported; some assembly language programming
is required. 32-bit Unix systems with conventional memory models
are most easily accommodated. See the documentation for porting
the SR language; MPD is ported in a similar manner.

<H2> Feedback </H2>
<P>
Please let us know of any problems you encounter so that we can
continue to improve MPD.
Our electronic mail address is
<A HREF="mailto:sr-project@cs.arizona.edu">
sr-project@cs.arizona.edu</A>.
To address any problems, we'll need to know what computer and
operating system you are using, and what version of MPD.
Because of limited resources we can't promise to fix every problem,
but we appreciate all comments and acknowledge all mail.

<H2> See Also </H2>

<P> <A HREF="release.html">Release notes.</A>

<P>
Gregory R. Andrews,
<I> Foundations of Multithreaded, Parallel, and Distributed Programming</I>.
Addison-Wesley, 2000, ISBN 0-201-35752-6.
<P>
MPD Language Documentation.
At the MPD web site, 
<A HREF="http://www.cs.arizona.edu/mpd/">
http://www.cs.arizona.edu/mpd/</A>.
<P>
SR documentation.
Available at
<A HREF="http://www.cs.arizona.edu/sr/doc.html">
http://www.cs.arizona.edu/sr/doc.html</A>.
</BODY>
</HTML>
